<!DOCTYPE html>
<html lang="id">
  <head>
    <meta charset="UTF-8" />
    <title>Masjid Al-Ikhlas RSUD Batang</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />

    <!-- BOOTSTRAP -->
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />

    <!-- CSS -->
    <link rel="stylesheet" href="mosq.css" />

    <!-- FavIcon -->
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/7.0.1/css/all.min.css"
      integrity="sha512-2SwdPD6INVrV/lHTZbO2nodKhrnDdJK9/kg2XD1r9uGqPo1cUbujc+IYdlYdEErWNu69gVcYgdxlmVmzTWnetw=="
      crossorigin="anonymous"
      referrerpolicy="no-referrer"
    />

    <!-- Google Font -->
    <style>
      @import url("https://fonts.googleapis.com/css2?family=Poppins:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap");
    </style>
  </head>

  <body>
    <div class="container-fluid text-center p-5">
      <!-- HEADER -->
      <div
        class="d-flex justify-content-center align-items-center mb-3 gap-3 mt-5"
      >
        <div>
          <h1 class="fw-bold">MASJID AL-IKHLAS</h1>
          <h4>RSUD BATANG</h4>
        </div>
      </div>

      <!-- TANGGAL -->
      <div class="fs-4 mb-2" id="tanggal"></div>

      <!-- JAM -->
      <div class="jam mb-4" id="jam"></div>

      <!-- SLIDE -->
      <div class="slide active" id="slideJadwal">
        <div class="row justify-content-center">
          <div class="col-lg-8">
            <div class="row-sholat d-flex justify-content-between" id="subuh">
              <div>Subuh</div>
              <div class="time">--:--</div>
            </div>

            <div class="row-sholat d-flex justify-content-between" id="dzuhur">
              <div>Dzuhur</div>
              <div class="time">--:--</div>
            </div>

            <div class="row-sholat d-flex justify-content-between" id="ashar">
              <div>Ashar</div>
              <div class="time">--:--</div>
            </div>

            <div class="row-sholat d-flex justify-content-between" id="maghrib">
              <div>Maghrib</div>
              <div class="time">--:--</div>
            </div>

            <div class="row-sholat d-flex justify-content-between" id="isya">
              <div>Isya</div>
              <div class="time">--:--</div>
            </div>
          </div>
        </div>
      </div>

      <!-- SLIDE -->
      <div class="slide" id="slideInfo">
        <div class="pengumuman p-5">
          <p>
            <i class="fa-solid fa-bell-slash"></i> Mohon mematikan / silent HP
          </p>
          <p><i class="fa-solid fa-mosque"></i> Luruskan dan rapatkan shaf</p>
          <p>
            <i class="fa-solid fa-person-praying"></i> Perbanyak dzikir dan doa
          </p>
        </div>
      </div>

      <div class="text-center mt-4 opacity-75 small">
        © 2026 Masjid Al-Ikhlas RSUD Batang – Kabupaten Batang<br />
      </div>
    </div>

    <script>
      // REALTIME
      function updateJam() {
        const sekarang = new Date();
        document.getElementById("jam").innerHTML = sekarang.toLocaleTimeString(
          "id-ID",
          {
            hour: "2-digit",
            minute: "2-digit",
            second: "2-digit",
          }
        );
      }
      setInterval(updateJam, 1000);
      updateJam();

      // TANGGAL MASEHI & HIJRIAH
      function updateTanggal() {
        fetch("https://api.aladhan.com/v1/gToH")
          .then((r) => r.json())
          .then((h) => {
            const masehi = new Date().toLocaleDateString("id-ID", {
              weekday: "long",
              day: "numeric",
              month: "long",
              year: "numeric",
            });
            const hijri = `${h.data.hijri.day} ${h.data.hijri.month.en} ${h.data.hijri.year} H`;
            document.getElementById("tanggal").innerHTML =
              masehi + " | " + hijri;
          });
      }
      updateTanggal();

      async function ambilJadwal() {
        const ID_BATANG = "1403";
        const hariIni = new Date();
        const tahun = hariIni.getFullYear();
        const bulan = String(hariIni.getMonth() + 1).padStart(2, "0");
        const tanggal = String(hariIni.getDate()).padStart(2, "0");

        const koreksiMenit = -2;

        const url = `https://api.myquran.com/v2/sholat/jadwal/${ID_BATANG}/${tahun}/${bulan}/${tanggal}`;

        try {
          const respon = await fetch(url);
          const hasil = await respon.json();

          if (hasil.status) {
            const j = hasil.data.jadwal;

            // menambah/mengurangi menit
            function sesuaikanWaktu(waktuAsli, menitTambahan) {
              let [jam, menit] = waktuAsli.split(":").map(Number);
              let date = new Date();
              date.setHours(jam);
              date.setMinutes(menit + menitTambahan);
              return date
                .toLocaleTimeString("id-ID", {
                  hour: "2-digit",
                  minute: "2-digit",
                })
                .replace(".", ":");
            }

            document.querySelector("#subuh .time").innerText = sesuaikanWaktu(
              j.subuh,
              koreksiMenit
            );
            document.querySelector("#dzuhur .time").innerText = sesuaikanWaktu(
              j.dzuhur,
              koreksiMenit
            );
            document.querySelector("#ashar .time").innerText = sesuaikanWaktu(
              j.ashar,
              koreksiMenit
            );
            document.querySelector("#maghrib .time").innerText = sesuaikanWaktu(
              j.maghrib,
              koreksiMenit
            );
            document.querySelector("#isya .time").innerText = sesuaikanWaktu(
              j.isya,
              koreksiMenit
            );

            console.log(
              `Jadwal Batang diterapkan dengan koreksi ${koreksiMenit} menit`
            );
          }
        } catch (e) {
          console.error("Gagal ambil jadwal:", e);
        }
      }

      ambilJadwal();
      setInterval(ambilJadwal, 3600000);

      // SLIDESHOW
      let slideIndex = 0;
      setInterval(() => {
        const slides = document.querySelectorAll(".slide");
        if (slides.length > 0) {
          slides.forEach((s) => s.classList.remove("active"));
          slideIndex = (slideIndex + 1) % slides.length;
          slides[slideIndex].classList.add("active");
        }
      }, 15000);
    </script>
  </body>
</html>
